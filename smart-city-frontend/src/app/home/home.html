<h1>Approved Shops & Services</h1>

<!-- New: Filters row -->
<div class="filters-row">
    <div class="search-container">
        <span class="material-icons search-icon">search</span>
        <input type="text" [(ngModel)]="searchQuery" (input)="updateFilters()" placeholder="Search by name, description, or address...">
    </div>
    <div class="category-filter">
        <select [(ngModel)]="selectedCategory" (change)="updateFilters()">
            <option value="">All Categories</option>
            @for (cat of categories; track cat.id || cat.name) {
                <option [value]="cat.name">{{ cat.name }}</option>
            }
        </select>
    </div>
</div>

<div class="content-wrapper">
    <!-- Left column: Scrollable list -->
    <div class="list-column">
        @if (filteredApproved.length === 0) {
        <div class="empty-state">
            <p>No approved services match your search.</p>
            <!-- NEW: Show location error if present -->
            @if (locationError) {
            <p class="error-message">{{ locationError }}</p>
            }
        </div>
        } @else {
        <div class="list-container">
            @for (item of filteredApproved; track item.id) {
            <div class="service-card" (click)="goToDetails(item.id)" style="cursor: pointer;">
                <h3>{{ item.name }}</h3>
                <div class="service-info">
                    <p><strong>Category:</strong> {{ item.category }}</p>
                    <p><strong>Address:</strong> {{ item.address }}</p>
                </div>
            </div>
            }
        </div>
        }
    </div>

    <!-- Right column: Map -->
    <div class="map-column">
        <div class="map-container" leaflet [leafletOptions]="options" [leafletLayers]="layers" (leafletMapReady)="onMapReady($event)">
        </div>
    </div>
</div>