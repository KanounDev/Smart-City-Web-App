<h2>Admin Panel - Pending Requests</h2>

@if (requests.length === 0) {
<p class="no-requests">No pending requests.</p>
} @else {
<div class="requests-list">
    @for (item of requests; track item.id) {
    <div class="request-card">
        <h3>{{ item.name }}</h3>
        <p><strong>Category:</strong> {{ item.category }}</p>
        <p><strong>Description:</strong> {{ item.description }}</p>
        <p><strong>Address:</strong> {{ item.address }}</p>
        <p><strong>Status:</strong>
            <span class="status-badge" [class]="getStatusClass(item.status)">
            {{ item.status }}
          </span>
        </p>
        <p><strong>Comments:</strong> {{ item.comments || 'None' }}</p>

        <!-- Added: Documents section (view only for admin) -->
        <div class="documents-section">
            <h4>Documents:</h4>
            @if (item.documents && item.documents.length > 0) {
            <ul class="file-list">
                @for (doc of item.documents; track $index) {
                <li>
                    <a [href]="getDownloadUrl(item.id, $index)" target="_blank" download>
                    {{ getFileName(doc) }}
                  </a>
                </li>
                }
            </ul>
            } @else {
            <p>No documents uploaded.</p>
            }
        </div>

        <!-- Action bar for approve/reject -->
        <div class="action-bar">
            <input type="text" placeholder="Admin Comments (e.g., request more docs)" #comments>
            <input type="number" placeholder="Lat" #lat>
            <input type="number" placeholder="Lng" #lng>
            <button class="approve" (click)="update(item.id, 'APPROVED', comments.value, lat.valueAsNumber, lng.valueAsNumber)">
            Approve
          </button>
            <button class="reject" (click)="update(item.id, 'REJECTED', comments.value, null, null)">
            Reject
          </button>
        </div>
    </div>
    }
</div>
}